{
  "author": "Comfortable-Ad-2379",
  "original_created_utc": 1658563064,
  "title": "OfficerBreaker - pptx/docx/xlsx password remover",
  "created_utc": 1658570431,
  "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Hi everyone!&lt;/p&gt;\n\n&lt;p&gt;In case you ever forget the password for any Microsoft Office file (pptx/xlsx/docx) you locked I built a &lt;a href=\"https://github.com/nedlir/OfficerBreaker\"&gt;tool&lt;/a&gt; that removes the password from the file without cracking it.&lt;/p&gt;\n\n&lt;h2&gt;How does it work?&lt;/h2&gt;\n\n&lt;p&gt;All pptx/xlsx/docx files are part of the Office Open XML format family (for further reading please refer to &lt;a href=\"https://www.loc.gov/preservation/digital/formats/fdd/fdd000395.shtml\"&gt;OOXML Format Family -- ISO/IEC 29500 and ECMA 376\n&lt;/a&gt;).&lt;/p&gt;\n\n&lt;p&gt;For example, a standard &lt;strong&gt;&lt;em&gt;.pptx&lt;/em&gt;&lt;/strong&gt; file will have the following file tree structure:\n&lt;code&gt;\nmyFile.pptx\n.\n├── docProps\n│   ├── app.xml\n│   ├── core.xml\n│   ├── custom.xml\n│   └── thumbnail.jpeg\n├── ppt\n│   ├── handoutMasters\n│   ├── media\n│   ├── media\n│   ...\n│   ...\n│   ...\n│   └── presentation.xml\n├── _rels\n│   ├── .rels\n└── [Content_Types].xml\n&lt;/code&gt;\nWe can see this structure by opening the file using a program like &lt;a href=\"https://www.7-zip.org/\"&gt;7zip&lt;/a&gt; or by changing the filetype to &lt;strong&gt;&lt;em&gt;.zip&lt;/em&gt;&lt;/strong&gt; and then opening it.&lt;/p&gt;\n\n&lt;p&gt;Each OOXML file type contains an &lt;strong&gt;&lt;em&gt;.xml&lt;/em&gt;&lt;/strong&gt; file with settings and preferences, including read-only protection. In our example the security element will be located inside &lt;code&gt;presentation.xml&lt;/code&gt; file which is located inside the &lt;code&gt;ppt&lt;/code&gt; folder of &lt;code&gt;myFile.pptx&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;Inside &lt;code&gt;presentation.xml&lt;/code&gt; there is a specific element we will focus on called &lt;strong&gt;p:modifyVerifier&lt;/strong&gt; which should look like this:&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;python\n&amp;lt;p:modifyVerifier cryptProviderType=&amp;quot;rsaAES&amp;quot; cryptAlgorithmClass=&amp;quot;hash&amp;quot; cryptAlgorithmType=&amp;quot;typeAny&amp;quot; cryptAlgorithmSid=&amp;quot;14&amp;quot; spinCount=&amp;quot;100000&amp;quot; saltData=&amp;quot;3R1lmtJocEj5GzEGRn3MHA==&amp;quot; hashData=&amp;quot;iR0jIUtVcGsTx62z/hqcbzaReLJemv$eZyqTlpWhl0Lph+osBKEiEYmyReJHmypMy6wj+VFmDGuNZvsMA9tX9g==&amp;quot;/&amp;gt;\n&lt;/code&gt;\nThe file editing is protected by a password which was salted and hashed which makes it nearly impossible to crack within reasonable time. But instead of trying to crack the password, we can just... Remove it. :shrug:&lt;/p&gt;\n\n&lt;p&gt;Turns out that simply deleting the security element &lt;strong&gt;p:modifyVerifier&lt;/strong&gt; as a whole will make &lt;code&gt;myFile.pptx&lt;/code&gt; behave as if it never had any password at all. This kind of security measure is a bit like the photo in the title of this repository - a good lock placed on the door handle... :sweat_smile:&lt;/p&gt;\n\n&lt;p&gt;The program will create a copy of &lt;code&gt;presentation.xml&lt;/code&gt;, parse it and delete the security element. Once the element is deleted, the &lt;em&gt;copied&lt;/em&gt; &lt;code&gt;presentation.xml&lt;/code&gt; will be replaced with the &lt;em&gt;original&lt;/em&gt; &lt;code&gt;presentation.xml&lt;/code&gt; which will effectively remove the password from &lt;code&gt;myFile.pptx&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;What makes this whole thing worse is the fact that we could simply remove the password created by the author, alter the file in some way and then return the original password of the author by inserting the same security element which was removed. This hurts the integrity of the whole OOXML format family.&lt;/p&gt;\n\n&lt;h3&gt;Future changes / possible deprecation&lt;/h3&gt;\n\n&lt;p&gt;Future versions of OOXML file type may make drastic changes of naming convention of elements or/and structure of the folders or/and files. This might make this repo deprecated but not obsolete if the same security measures will be taken in future versions.\nIf a &amp;quot;lock with different name&amp;quot; (the hashing) will be placed on the &amp;quot;door handle&amp;quot; (removable &lt;code&gt;.xml&lt;/code&gt; element), the file still could be altered/edited without a password. All that&amp;#39;s needed is to find the new security element and simply remove it from the file.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://github.com/nedlir/OfficerBreaker\"&gt;https://github.com/nedlir/OfficerBreaker&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;",
  "score": 5,
  "preview": {
    "images": [
      {
        "source": {
          "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?auto=webp&amp;s=5d345c5dc7dc613ea8a9a122415b900e9692cbd4",
          "width": 1200,
          "height": 600
        },
        "resolutions": [
          {
            "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?width=108&amp;crop=smart&amp;auto=webp&amp;s=af4ea8d949d8c6a46fb601becd29835c4f196fc8",
            "width": 108,
            "height": 54
          },
          {
            "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?width=216&amp;crop=smart&amp;auto=webp&amp;s=2f3c9f842ad69ed4a698d96cf1a13b2ae0741a80",
            "width": 216,
            "height": 108
          },
          {
            "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?width=320&amp;crop=smart&amp;auto=webp&amp;s=15083223fa85b7d699824a6a4dd75e866b76e574",
            "width": 320,
            "height": 160
          },
          {
            "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?width=640&amp;crop=smart&amp;auto=webp&amp;s=44c6774bf1f3e73990bcbd573ce2527e994c9253",
            "width": 640,
            "height": 320
          },
          {
            "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?width=960&amp;crop=smart&amp;auto=webp&amp;s=891ff8b0a4524fc5ee5d1e4c4d6612dc56fe2f34",
            "width": 960,
            "height": 480
          },
          {
            "url": "https://external-preview.redd.it/tTNn1kemkGLh2adRDmqdQ-maIsFf_EbGJRb_DkF2Kkg.jpg?width=1080&amp;crop=smart&amp;auto=webp&amp;s=4045d30479cf402e60c6704b35f2d9b0bc6b71fb",
            "width": 1080,
            "height": 540
          }
        ],
        "variants": {},
        "id": "_jdToPG8XT_21woX19-CprEdYicg4PPkDCc6aMoIZiE"
      }
    ],
    "enabled": false
  },
  "permalink": "/r/SideProject/comments/w5ygpp/officerbreaker_pptxdocxxlsx_password_remover/",
  "subreddit": "SideProject",
  "id": "w5ygpp",
  "is_self": true,
  "media": null,
  "is_video": false,
  "sensitive": false,
  "the_new_excerpt": "Hi everyone!\n\nIn case you ever forget the password for any Microsoft Office file\n(pptx/xlsx/docx) you locked I built a tool\n[https://github.com/nedlir/OfficerBreaker] that removes the password from the\nfile without cracking it.\n\n\nHOW DOES IT WORK?\n\nAll pptx/xlsx/docx files are part of the Office…",
  "localize": [
    {
      "locale": "ja",
      "the_new_excerpt": "みなさん、こんにちは。\n\nMicrosoft Officeファイル（pptx/xlsx/docx）をロックした際に、パスワードを忘れてしまった場合のために\n(pptx/xlsx/docx) のパスワードを忘れてしまった場合、以下のツールを作成しました。\n[https://github.com/nedlir/OfficerBreaker]を作りました。\nファイルからパスワードを削除するツールを作りました。\n\n\nどのように動作するのでしょうか？\n\nすべてのpptx/xlsx/docxファイルはOfficeの一部です...",
      "title": "OfficerBreaker - pptx/docx/xlsx パスワードリムーバー"
    },
    {
      "locale": "zh",
      "the_new_excerpt": "大家好!\n\n如果你忘记了任何微软Office文件的密码\n(pptx/xlsx/docx)，我建立了一个工具\n[https://github.com/nedlir/OfficerBreaker]，可以从\n文件中删除密码，而不需要破解它。\n\n\n它是如何工作的？\n\n所有pptx/xlsx/docx文件都是Office的一部分。",
      "title": "OfficerBreaker - pptx/docx/xlsx密码去除器"
    },
    {
      "locale": "zh-Hant",
      "the_new_excerpt": "大家好!\n\n如果你忘記了任何微軟Office文件的密碼\n(pptx/xlsx/docx)，我建立了一個工具\n[https://github.com/nedlir/OfficerBreaker]，可以從\n文件中刪除密碼，而不需要破解它。\n\n\n它是如何工作的？\n\n所有pptx/xlsx/docx文件都是Office的一部分。",
      "title": "OfficerBreaker - pptx/docx/xlsx密碼去除器"
    }
  ]
}